# 西班牙语动词变位战斗（GUI + CLI）

一个极简小游戏：用正确的西语变位来打 Boss。包含回合制战斗、商店购买技能、大回合强化等核心循环。支持 Tkinter 图形界面与命令行两种玩法。

## 运行（推荐 GUI）

- 需要 Python 3.9+
- 在项目根目录运行：

```bash
python main.py
```

命令行版本：

```bash
python main.py --cli
```

## 词库（JSON）

- 路径：`data/verbs.json`
- 作用：
  - 游戏启动时加载词库作为动词卡来源。
  - 出牌判定时，若词库提供了该动词的人称对应形式，会优先用词库核对是否正确（支持不规则动词）。
- 规则卡：
  - 通用规则卡：如 `ar->o`、`er->es` 等，适用于相应词尾的规则动词。
  - 不规则规则卡：从词库生成，形如 `ar->voy`、`ir->digo`，并带有 `verb_infinitive` 限定为某个特定动词（例如 `ir` 的 "voy"）。只有在该动词上使用才有效。
- 数据结构示例：

```json
{
  "metadata": {"version": 1, "language": "es"},
  "verbs": [
    {
      "infinitive": "ir",
      "present_indicative": {
        "直陈式现在时+第一人称单数": "voy",
        "直陈式现在时+第二人称单数": "vas"
      }
    }
  ]
}
```

- 若文件不存在或为空，将回退到内置的示例动词列表与规则验证。

## 玩法概述

- 每个小回合：
  - Boss 出题（例如：直陈式现在时+第一人称单数）。
  - 你有两类卡：动词原形卡和变化卡（包含通用与不规则专属卡）。
  - 选择任意一个动词卡 + 任意一个变化卡组合；若与题目人称匹配且词库/规则验证正确则造成伤害，否则被 Boss 反击扣血。
- 商店：
  - 小回合后可花金币购买技能（例如含 "->" 的变化卡伤害×3）。
- 大回合：
  - 打败 Boss 进入下一大回合，提高 Boss 初始生命和增长速率。
  - 大回合结束可选 1 项强化：动词卡+1、变化卡+1、或 50% 概率保留打出卡。

## 目前支持的变位

- 直陈式现在时（规则动词）：
  - -ar: o, as, a, amos, áis, an
  - -er: o, es, e, emos, éis, en
  - -ir: o, es, e, imos, ís, en

不规则动词暂未实现。

## 主要文件

- `main.py`：程序入口（默认 GUI，`--cli` 运行命令行）
- `game/ui.py`：Tkinter 图形界面
- `game/cli.py`：命令行交互主循环
- `game/models.py`：数据模型（玩家、Boss、卡、状态）
- `game/logic.py`：游戏流程、战斗与商店、强化（含 UI API 和词库整合）
- `game/lexicon.py`：词库读取工具
- `game/rules.py`：现在时规则（通用 + 不规则专属）与应用

## 备注

- 这是最小可玩的原型，便于快速验证玩法。可在 `game/logic.py` 与 `game/rules.py` 中扩展更多时态、技能与事件。
